
<div >
    <div class="p-15" >
        <div class="items-header">
            <div >
            <h3>Items</h3>
        </div>
         <div>
     
        
         <form id="uploader">
    <span class="bulkImportText">Bulk Import:</span>
    <input id="fileInput" type="file" multiple>
    <input type="submit" value="Upload file" />
    <span class="pl-30">Click to download sample csv file</span>
           <a href="@Url.Action("DownloadCSV", "Home")" download id="download1"><i class="bi bi-download"></i> Download CSV </a>
</form>
            
         </div>
        </div>
        

<div id="itemsGrid">

</div>
    </div>
</div>

<div >
    <div class="p-15">

       
    @*<table class="table table-bordered">
        <thead class="text-white bg-custom">
           <tr>
            <th>
               GTIN
            </th>
            <th>
               Catalog_Num
            </th>
            <th>
                Shelf_Life
            </th>
            <th>
                Label_Spec
            </th>
            <th>
                IFU
            </th>
            <th>
                Edit_Date_Time
            </th>
            <th>
                Edit_By
            </th>
            <th>
                Created
            </th>
            <th>
                Created_by
            </th>
        </tr>
        </thead>
        <tbody>
            <tr data-row-id="1">
            <td><div data-new-gtin contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
            <td><div contenteditable="true" ></div></td>
        </tr>
        </tbody>
    </table>*@
   @* <div class="button=div add-button">
          <a class="login-button"><span class="login-text">Add Item</span></a>
    </div>*@
</div>
    </div>

<style>
    .bulkImportText{
       vertical-align: -2px;
       font-size: 27px;
       font-weight: 400;
    }

    .pl-30{
        padding-left:30px;
    }

    .items-header{
        display: flex;
        justify-content: space-between;
    }

    .bg-custom{
        background:#003C71;
    }
     .login-button{
        display: block;
        width: 150px;
        height: 55px;
        background: #003C71;
        padding: 5px;
        text-align: center;
        border-radius: 12px;
        color: white;
        font-weight: bold;
        line-height: 40px;
        margin: auto;
        text-decoration: none;
    }

    .button-div{
        cursor:pointer;
    }

    .login-text{
        font-size:24px;
        font-weight:500;
    }

    .p-15{
        padding: 15px 15px 15px 15px;
    }
</style>



<script>
$(() => {

    document.getElementById('uploader').onsubmit = function () {
    var formdata = new FormData(); //FormData object
    var fileInput = document.getElementById('fileInput');
    //Iterating through each files selected in fileInput
    formdata.append('file', fileInput.files[0]);
    //Creating an XMLHttpRequest and sending
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/uploadItemsExcel');
    xhr.send(formdata);
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
            //alert(xhr.responseText);
        }
    }
    return false;
}   


    getItems();

    //document.getElementsByClassName('add-button')[0]
    //    .addEventListener('click', function(event) {
    //        console.log("add button clicked");

    //        var row = $('[data-row-id="1"]'); // Target the row using the custom attribute

    //        var gtin = row.find('[data-new-gtin]'); // Get the GTIN value from the specific div using [data-new-gtin] attribute selector
    //        var catalogNo = row.find('td:nth-child(2) div'); // Get the value from the second column div
    //        var shelfLife = row.find('td:nth-child(3) div');
    //        var lableSpec = row.find('td:nth-child(4) div');
    //        var ifu = row.find('td:nth-child(5) div');
    //        var editDateTime = row.find('td:nth-child(6) div');
    //        var editBy = row.find('td:nth-child(7) div');
    //        var created = row.find('td:nth-child(8) div');
    //        var createdBy = row.find('td:nth-child(9) div');

    //        var item = {
    //            GTIN: gtin.text(),
    //            Catalog_Num: catalogNo.text(),
    //            Shelf_Life: shelfLife.text(),
    //            Label_Spec: lableSpec.text(),
    //            IFU: ifu.text(),
    //            Edit_Date_Time: editDateTime.text(),
    //            Edit_By: editBy.text(),
    //            Created: created.text(),
    //            Created_by: createdBy.text()
    //        };

    //        //saveNewItem(item);

    //        var apiUrl = "https://localhost:7157/SaveNewItem";

    //        $.ajax({
    //            url: apiUrl,
    //            method: "POST",
    //            data: item,
    //            success: function(response) {
    //                console.log("Item saved successfully");
    //                getItems();
    //                gtin.text(''),
    //                    catalogNo.text(''),
    //                    shelfLife.text(''),
    //                    lableSpec.text(''),
    //                    ifu.text(''),
    //                    editDateTime.text(''),
    //                    editBy.text(''),
    //                    created.text(''),
    //                    createdBy.text('')
    //            },
    //            error: function(xhr, status, error) {
    //                console.log("An error occurred while saving the data:", error);
    //            }
    //        });

    //        console.log(gtin);
    //        console.log(catalogNo);
    //        console.log(shelfLife);

    //    });

    function getItems() {
        console.log("get items called");
        $.ajax({
            url: '@Url.Action("RefreshItemsGrid", "Home")',
            dataType: 'html',
            method: 'GET',
            success: function(res) {
                 $("#itemsGrid").html('').html(res);
            },
            error: function(err) {
                console.log(err);
            }
        })
    }


});


</script>